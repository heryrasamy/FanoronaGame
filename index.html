<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jeu de StratÃ©gie</title>
    <style>
        :root {
            --wood-light: #DEB887;
            --wood-medium: #CD853F;
            --wood-dark: #8B4513;
            --wood-darker: #654321;
            --line: #654321;
            --white-piece: #F8F8FF;
            --white-shadow: #E0E0E0;
            --black-piece: #2F2F2F;
            --black-shadow: #1A1A1A;
            --glow-white: #87CEEB;
            --glow-black: #FF6347;
            --move-highlight: #32CD32;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--wood-dark), var(--wood-medium));
            color: white;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }

        h1 {
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            font-size: 2.5em;
            background: linear-gradient(45deg, #FFD700, #FFA500);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .game-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            max-width: 1200px;
            width: 100%;
        }

        .info-panel {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            max-width: 600px;
            background: rgba(139, 69, 19, 0.8);
            padding: 15px 25px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
            border: 2px solid var(--wood-darker);
            box-shadow: 0 8px 32px rgba(0,0,0,0.3);
        }

        .score {
            display: flex;
            align-items: center;
            gap: 15px;
            font-size: 1.2em;
            font-weight: bold;
        }

        .score-piece {
            width: 25px;
            height: 25px;
            border-radius: 50%;
            display: inline-block;
            box-shadow: 0 2px 8px rgba(0,0,0,0.4);
        }

            .score-piece.white {
                background: radial-gradient(circle at 30% 30%, var(--white-piece), var(--white-shadow));
                border: 2px solid #D3D3D3;
            }

            .score-piece.black {
                background: radial-gradient(circle at 30% 30%, #404040, var(--black-piece));
                border: 2px solid #1A1A1A;
            }

        #gameStatus {
            padding: 10px 20px;
            border-radius: 25px;
            font-weight: bold;
            text-align: center;
            color: white;
            min-width: 200px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            transition: all 0.3s ease;
        }

        #resetButton {
            background: linear-gradient(135deg, #FF6B6B, #FF5252);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            font-size: 1em;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(255, 107, 107, 0.3);
        }

            #resetButton:hover {
                transform: translateY(-2px);
                box-shadow: 0 6px 20px rgba(255, 107, 107, 0.4);
                background: linear-gradient(135deg, #FF5252, #FF3030);
            }

        #boardWrapper {
            position: relative;
            width: 600px;
            height: 334px;
            background: linear-gradient(135deg, var(--wood-light), var(--wood-medium));
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3), inset 0 2px 10px rgba(255,255,255,0.1), inset 0 -2px 10px rgba(0,0,0,0.2);
            border: 3px solid var(--wood-darker);
        }

            #boardWrapper::before {
                content: '';
                position: absolute;
                top: 10px;
                left: 10px;
                right: 10px;
                bottom: 10px;
                background: repeating-linear-gradient( 90deg, transparent 0px, rgba(139, 69, 19, 0.1) 1px, transparent 2px, transparent 20px ), repeating-linear-gradient( 0deg, transparent 0px, rgba(139, 69, 19, 0.05) 1px, transparent 2px, transparent 15px );
                border-radius: 15px;
                pointer-events: none;
            }

        #boardCanvas {
            position: absolute;
            top: 20px;
            left: 20px;
            pointer-events: none;
            z-index: 1;
        }

        #boardContainer {
            position: relative;
            width: 100%;
            height: 100%;
            display: grid;
            grid-template-columns: repeat(9, 1fr);
            grid-template-rows: repeat(5, 1fr);
            gap: 0;
            z-index: 2;
        }

        .cell {
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            position: relative;
            transition: all 0.3s ease;
            border-radius: 50%;
        }

            .cell::before {
                content: '';
                position: absolute;
                width: 80%;
                height: 80%;
                border-radius: 50%;
                transition: all 0.3s ease;
                z-index: -1;
            }

            .cell.player::before {
                background: radial-gradient(circle at 30% 30%, var(--white-piece), var(--white-shadow));
                border: 3px solid #D3D3D3;
                box-shadow: 0 4px 12px rgba(0,0,0,0.3), inset 2px 2px 5px rgba(255,255,255,0.3), inset -2px -2px 5px rgba(0,0,0,0.1);
            }

            .cell.ai::before {
                background: radial-gradient(circle at 30% 30%, #404040, var(--black-piece));
                border: 3px solid #1A1A1A;
                box-shadow: 0 4px 12px rgba(0,0,0,0.5), inset 2px 2px 5px rgba(255,255,255,0.1), inset -2px -2px 5px rgba(0,0,0,0.3);
            }

            .cell.selected::before {
                animation: pulse 1.5s infinite;
                box-shadow: 0 0 20px var(--glow-white), 0 4px 12px rgba(0,0,0,0.3), inset 2px 2px 5px rgba(255,255,255,0.3), inset -2px -2px 5px rgba(0,0,0,0.1);
            }

            .cell.selected.ai::before {
                box-shadow: 0 0 20px var(--glow-black), 0 4px 12px rgba(0,0,0,0.5), inset 2px 2px 5px rgba(255,255,255,0.1), inset -2px -2px 5px rgba(0,0,0,0.3);
            }

            .cell.possible-move::after {
                content: '';
                position: absolute;
                width: 40%;
                height: 40%;
                background: var(--move-highlight);
                border-radius: 50%;
                animation: moveHint 2s infinite;
                box-shadow: 0 0 15px var(--move-highlight);
            }

            .cell:hover {
                transform: scale(1.05);
            }

            .cell.player:hover::before,
            .cell.ai:hover::before {
                transform: scale(1.1);
            }

        @keyframes pulse {
            0%, 100% {
                box-shadow: 0 0 20px var(--glow-white), 0 4px 12px rgba(0,0,0,0.3), inset 2px 2px 5px rgba(255,255,255,0.3), inset -2px -2px 5px rgba(0,0,0,0.1);
            }

            50% {
                box-shadow: 0 0 40px var(--glow-white), 0 6px 20px rgba(0,0,0,0.4), inset 2px 2px 8px rgba(255,255,255,0.4), inset -2px -2px 8px rgba(0,0,0,0.2);
            }
        }

        @keyframes moveHint {
            0%, 100% {
                opacity: 0.6;
                transform: scale(1);
            }

            50% {
                opacity: 1;
                transform: scale(1.2);
            }
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 2em;
            }

            #boardWrapper {
                width: 90vw;
                height: calc(90vw * 334/600);
                max-width: 500px;
                max-height: 278px;
            }

            .info-panel {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }

            .score {
                font-size: 1em;
            }
        }
    </style>
</head>
<body>
    <h1>ðŸŽ¯ Jeu de StratÃ©gie</h1>

    <div class="game-container">
        <div class="info-panel">
            <div class="score">
                <span class="score-piece white"></span>
                <span>Joueur: </span>
                <span id="whiteScore">22</span>
            </div>

            <div id="gameStatus">Ã€ ton tour - Attaquez l'IA !</div>

            <div class="score">
                <span class="score-piece black"></span>
                <span>IA: </span>
                <span id="blackScore">22</span>
            </div>
        </div>

        <div id="boardWrapper">
            <canvas id="boardCanvas"></canvas>
            <div id="boardContainer"></div>
        </div>

        <button id="resetButton">ðŸ”„ Nouvelle Partie</button>
    </div>

    <script>
        window.addEventListener("DOMContentLoaded", () => {
            // === TON SCRIPT V1.0 COMMENCE ICI ===
            // ===== ParamÃ¨tres du plateau =====
            const ROWS = 5;
            const COLS = 9;

            let board = [];
            let selected = null;
            let possibleMoves = [];
            let playerTurn = true;
            let whiteScore = 22;
            let blackScore = 22;
            let gameEnded = false;
            let moveHistory = [];
            let captureSequence = false;
            let lastMovePosition = null;

            // ===== RÃ‰GLAGE CANVAS =====
            const boardWrapper = document.getElementById('boardWrapper');
            const boardContainer = document.getElementById('boardContainer');
            const boardCanvas = document.getElementById('boardCanvas');
            const ctx = boardCanvas.getContext('2d');

            function drawBoardCanvas() {
                const w = boardWrapper.clientWidth - 40; // Ajustement pour le padding
                const h = boardWrapper.clientHeight - 40;
                const dpr = window.devicePixelRatio || 1;
                boardCanvas.width = Math.floor(w * dpr);
                boardCanvas.height = Math.floor(h * dpr);
                boardCanvas.style.width = w + 'px';
                boardCanvas.style.height = h + 'px';
                ctx.setTransform(dpr, 0, 0, dpr, 0, 0);

                ctx.clearRect(0, 0, w, h);

                const cellW = w / COLS;
                const cellH = h / ROWS;
                ctx.strokeStyle = getComputedStyle(document.documentElement).getPropertyValue('--line').trim() || '#654321';
                ctx.lineWidth = 2;

                const P = (r, c) => [c * cellW + cellW / 2, r * cellH + cellH / 2];

                ctx.beginPath();
                for (let r = 0; r < ROWS; r++) {
                    for (let c = 0; c < COLS; c++) {
                        const [x, y] = P(r, c);
                        if (c + 1 < COLS) { const [x2, y2] = P(r, c + 1); ctx.moveTo(x, y); ctx.lineTo(x2, y2); }
                        if (r + 1 < ROWS) { const [x2, y2] = P(r + 1, c); ctx.moveTo(x, y); ctx.lineTo(x2, y2); }
                        if (r + 1 < ROWS && c + 1 < COLS) { const [x2, y2] = P(r + 1, c + 1); ctx.moveTo(x, y); ctx.lineTo(x2, y2); }
                        if (r + 1 < ROWS && c - 1 >= 0) { const [x2, y2] = P(r + 1, c - 1); ctx.moveTo(x, y); ctx.lineTo(x2, y2); }
                    }
                }
                ctx.stroke();

                ctx.lineWidth = 4;
                ctx.strokeRect(cellW / 2, cellH / 2, w - cellW, h - cellH);
            }

            window.addEventListener('resize', drawBoardCanvas);

            // ===== Initialisation du plateau =====
            function initBoard() {
                boardContainer.innerHTML = '';
                for (let i = 0; i < ROWS; i++) {
                    for (let j = 0; j < COLS; j++) {
                        const cell = document.createElement('div');
                        cell.classList.add('cell');
                        cell.dataset.row = i;
                        cell.dataset.col = j;
                        // Pas de texte, les pions sont gÃ©rÃ©s par CSS
                        if (board[i][j] === "B") cell.classList.add('ai');
                        if (board[i][j] === "W") cell.classList.add('player');
                        if (selected && selected[0] === i && selected[1] === j) cell.classList.add('selected');
                        cell.addEventListener('click', () => handleCellClick(i, j));
                        boardContainer.appendChild(cell);
                    }
                }
                updateScore();
                updateStatus();
                drawBoardCanvas();
            }

            // ===== CrÃ©ation du plateau initial =====
            function createInitialBoard() {
                board = [
                    ["W", "W", "W", "W", "W", "W", "W", "W", "W"],
                    ["W", "W", "W", "W", "W", "W", "W", "W", "W"],
                    ["B", "W", "B", "W", " ", "B", "W", "B", "W"],
                    ["B", "B", "B", "B", "B", "B", "B", "B", "B"],
                    ["B", "B", "B", "B", "B", "B", "B", "B", "B"]
                ];
                selected = null;
                possibleMoves = [];
                playerTurn = true;
                whiteScore = 22;
                blackScore = 22;
                gameEnded = false;
                moveHistory = [];
                captureSequence = false;
                lastMovePosition = null;
            }

            // ===== Gestion du clic =====
            function handleCellClick(i, j) {
                if (gameEnded || !playerTurn) return;
                if (selected) {
                    const [si, sj] = selected;
                    if (possibleMoves.some(([mi, mj]) => mi === i && mj === j)) {
                        movePiece([si, sj], [i, j]);
                        return;
                    } else { selected = null; possibleMoves = []; initBoard(); }
                }
                if (board[i][j] === "W") {
                    selected = [i, j];
                    possibleMoves = getValidMoves(i, j);
                    initBoard();
                    possibleMoves.forEach(([mi, mj]) => {
                        const cell = document.querySelector(`[data-row="${mi}"][data-col="${mj}"]`);
                        if (cell) cell.classList.add('possible-move');
                    });
                }
            }

            // ===== DÃ©placement d'un pion =====
            function movePiece(from, to) {
                const [fi, fj] = from; const [ti, tj] = to;
                const captures = checkCaptures(fi, fj, ti, tj, "W");
                captures.forEach(([ci, cj]) => board[ci][cj] = " ");
                board[ti][tj] = board[fi][fj]; board[fi][fj] = " ";
                selected = [ti, tj]; possibleMoves = getAdditionalCaptures(ti, tj, [fi, fj]);
                if (possibleMoves.length > 0) { document.getElementById('gameStatus').textContent = " Capture multiple - Continuez l'attaque !"; return; }
                selected = null; possibleMoves = []; playerTurn = false; initBoard();
                if (!checkGameEnd()) setTimeout(makeAIMove, 500);
            }

            // ===== Mouvements valides =====
            function getValidMoves(i, j) {
                const moves = []; const dirs = [[-1, -1], [-1, 0], [-1, 1], [0, -1], [0, 1], [1, -1], [1, 0], [1, 1]];
                dirs.forEach(([di, dj]) => { const ni = i + di, nj = j + dj; if (ni >= 0 && ni < ROWS && nj >= 0 && nj < COLS && board[ni][nj] === " ") { moves.push([ni, nj]); } });
                return moves;
            }

            // ===== Captures =====
            function checkCaptures(fromI, fromJ, toI, toJ, player) {
                const opp = player === "W" ? "B" : "W"; const caps = []; const di = toI - fromI, dj = toJ - fromJ;
                let ni = toI + di, nj = toJ + dj;
                while (ni >= 0 && ni < ROWS && nj >= 0 && nj < COLS && board[ni][nj] === opp) { caps.push([ni, nj]); ni += di; nj += dj; }
                ni = fromI - di; nj = fromJ - dj;
                while (ni >= 0 && ni < ROWS && nj >= 0 && nj < COLS && board[ni][nj] === opp) { caps.push([ni, nj]); ni -= di; nj -= dj; }
                return caps;
            }

            // ===== Captures supplÃ©mentaires =====
            function getAdditionalCaptures(i, j, prev) { const m = getValidMoves(i, j); return m.filter(([ni, nj]) => checkCaptures(i, j, ni, nj, "W").length > 0); }

            // ===== IA =====
            function makeAIMove() {
                if (gameEnded) return;
                const moves = [];
                for (let i = 0; i < ROWS; i++) { for (let j = 0; j < COLS; j++) { if (board[i][j] === "B") { const val = getValidMoves(i, j); val.forEach(([ni, nj]) => { const caps = checkCaptures(i, j, ni, nj, "B"); moves.push({ from: [i, j], to: [ni, nj], captures: caps }); }); } } }
                if (moves.length === 0) return;
                moves.sort((a, b) => b.captures.length - a.captures.length);
                const m = moves[0]; const [si, sj] = m.from, [ti, tj] = m.to; m.captures.forEach(([ci, cj]) => board[ci][cj] = " "); board[ti][tj] = board[si][sj]; board[si][sj] = " "; playerTurn = true; initBoard(); checkGameEnd();
            }

            // ===== Fin de partie =====
            function checkGameEnd() {
                const w = board.flat().filter(c => c === "W").length, b = board.flat().filter(c => c === "B").length;
                if (w === 0) { document.getElementById('gameStatus').textContent = " L'IA a gagnÃ© !"; gameEnded = true; return true; }
                if (b === 0) { document.getElementById('gameStatus').textContent = "Bravo, Tu as gagnÃ© !"; gameEnded = true; return true; }
                return false;
            }

            // ===== Scores =====
            function updateScore() {
                document.getElementById('whiteScore').textContent = board.flat().filter(c => c === "W").length;
                document.getElementById('blackScore').textContent = board.flat().filter(c => c === "B").length;
            }

            // ===== Statut =====
            function updateStatus() {
                if (gameEnded) return; const s = document.getElementById('gameStatus');
                if (playerTurn) { s.textContent = "Ã€ ton tour - Attaquez l'IA !"; s.style.background = "linear-gradient(135deg,#27ae60,#2ecc71)"; }
                else { s.textContent = "L'IA va attaquer prÃ©pare toi !"; s.style.background = "linear-gradient(135deg,#e74c3c,#c0392b)"; }
            }

            // ===== RÃ©initialisation =====
            document.getElementById('resetButton').addEventListener('click', () => { createInitialBoard(); initBoard(); });

            // ===== DÃ©marrage =====
            window.onload = function () { createInitialBoard(); initBoard(); };

        });
    </script>
</body>
</html>